<!doctype html><html xmlns="http://www.w3.org/1999/xhtml"><head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns#"><script>var loc = new String(window.location); if (loc.indexOf('facebook.github.io/buck') != -1) {window.location.replace(loc.replace('facebook.github.io/buck', 'buck.build'));}</script><!-- Facebook Pixel Code --><script>!function(f,b,e,v,n,t,s){if(f.fbq)return;n=f.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)};if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';n.queue=[];t=b.createElement(e);t.async=!0;t.src=v;s=b.getElementsByTagName(e)[0];s.parentNode.insertBefore(t,s)}(window,document,'script','//connect.facebook.net/en_US/fbevents.js'); fbq('init', '1637165926500152'); fbq('track', 'PageView');</script><noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=1637165926500152&ev=PageView&noscript=1" /></noscript><!-- End Facebook Pixel Code --><title>Buck: Flavors</title><link type="image/png" rel="shortcut icon" href="/static/favicon.png" /><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no" /><meta http-equiv="content-type" content="text/html;charset=utf-8"><link type="text/css" rel="stylesheet" href="/google-code-prettify/prettify.css" ><link type="text/css" rel="stylesheet" href="/static/buck.css"><link type="text/css" rel="stylesheet" href="/static/search.css"><link type="text/css" rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css" /><meta property="og:locale" content="en_US"><meta property="og:title" content="Flavors"><meta property="og:site_name" content="Buck: a build tool"><meta property="og:image" content="http://buck.build/static/og.png"><meta property="og:type" content="article"><meta property="og:description" content="Flavors in Buck are a way to specify different variations of a build that otherwise share most configuration specifications."><meta property="fb:admins" content="584556688222168"><script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-44373548-18', 'auto');
    ga('send', 'pageview');
  </script></head><body><div id="fb-root"></div><script>(function(d, s, id) {var js, fjs = d.getElementsByTagName(s)[0]; if (d.getElementById(id)) return; js = d.createElement(s); js.id = id; js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=584556688222168"; fjs.parentNode.insertBefore(js, fjs);}(document, 'script', 'facebook-jssdk'));</script><header class='topbar'><nav class='width'><a href='http://buck.build/'><h1>Buck</h1></a><ul class='menu'><li class="algolia-search-wrapper"><input id="algolia-doc-search" type="search" placeholder="Search docs..." /></li><li><a href='/setup/getting_started.html'>Docs</a><li><a href='https://github.com/facebook/buck/issues'>Issues</a><li><a href='https://github.com/facebook/buck'>GitHub</a></ul></nav></header><section class='content'><div class='width'><article id="content"><h1>Flavors</h1><div class="overview"><p>Flavors in Buck are a way to specify different variations of a build that otherwise share most configuration specifications.</p><p>Flavors can also be used to simultaneously build for two different platforms, such as iOS and watchOS. Being able to build for both of these at the same time is important because iOS application can have a dependency on the Watch application.</p><p>Flavors fall into a number of different categories:</p><ul><li><a href='#platform_http'>Platform</a></li><li><a href='#linker_http'>Linker</a></li><li><a href='#symbol_http'>Symbol</a></li><li><a href='#analysis_http'>Analysis</a></li><li><a href='#header_http'>Header</a></li><li><a href='#apple_debug_http'>Apple debug</a></li><li><a href='#apple_bundles_http'>Apple bundles</a></li></ul><h2>Syntax for flavors</h2><p>A flavor is specified as a suffix to a build target, with the hash mark (#) used as a separator between the target and flavor. Examples:</p>
<pre>
buck build :cxx_gr_name#default
buck build :cxx_gr_name#iphonesimulator-x86_64
</pre>
<p>You can specify multiple flavors for a single target by separating the flavors with commas:</p>
<pre>
buck build Libraries/3rdParty/openssl:ssl#android-armv7,static-pic
buck build Libraries/3rdParty/openssl:ssl#android-x86,static-pic
buck build :bundle#iphoneos-x86_64,strip-all,dwarf-and-dsym
</pre>
<p><b>NOTE:</b> Buck supports a <a href="/concept/build_target_pattern.html">build target pattern</a>,<code>...</code>, as in, <code>//apps/...</code>, that specifies that Buck should recurse through build files in subdirectories, building all build targets in any build files it finds. <em>This build target pattern does not support specifying flavors.</em></p><h3>Default flavors</h3><p>The <code>cxx_library</code> and <code>apple_library</code> rules support specifying <em>default flavors</em>, which pertain if a build target is specified 1) explicitly-that is, not using a <a href="/concept/build_target_pattern.html">build target pattern</a>-and 2) without a flavor.</p><h3>Syntax for Flagfile Flavors</h3><p>A flavor may also be specified as a suffix to an @file or --flagfile argument. These flavors are used within the flagfile only and do not directly change the target flavor. The separator is '#' as above, and if the separator and flavor are present, the @file (aka flagfile) must end in ".py" and be a Python script. The script will be called as follows:</p>
<pre>
python /path/to/flagfile.py --flavors <flavor>
</pre>
<h2 id="platform_http">Platform flavors <a class="inline-link" href="#platform_http">#</a></h2><p>These flavors denote a toolchain to use for compiling. You can also use them to control conditional fields in the Buck target's rule.</p><table><tr><th>Flavor</th><th>Meaning</th></tr><tr><td>android-armv7</td><td>32-bit Android device</td></tr><tr><td>android-x86</td><td>32-bit Android emulator</td></tr><tr><td>iphoneos</td><td></td></tr><tr><td>iphoneos-armv7</td><td>32-bit iPhone device</td></tr><tr><td>iphoneos-arm64</td><td>64-bit iPhone device</td></tr><tr><td>iphoneos-i386</td><td></td></tr><tr><td>iphoneos-x86_64</td><td></td></tr><tr><td>iphonesimulator</td><td></td></tr><tr><td>iphonesimulator-i386</td><td>Simulator on 32-bit Mac</td></tr><tr><td>iphonesimulator-x86_64</td><td>Simulator on 64-bit Mac</td></tr><tr><td>macosx-x86_64</td><td>Native x86_64 OSX application</td></tr><tr><td>macosx-arm64</td><td>Native arm64 OSX application</td></tr><tr><td>windows-x86_64</td><td>Native Windows application</td></tr></table><p>Sighted in the wild:</p>
<pre>
buck build :main#android-arm64,shared
</pre>
<h2 id="linker_http">Linker flavors <a class="inline-link" href="#linker_http">#</a></h2><h3>Static</h3>
<pre>
static
</pre>
<p>Static library (.a)</p><h3>Position-independent code (PIC)</h3>
<pre>
static-pic
</pre>
<p>Static library that generates position-independent code (PIC). Note that on the Apple platforms, everything is PIC.</p><h3>Shared</h3><p>A shared library (so) or dynamically-loaded module (.dylib on Mac, .dll on Windows).</p><h3>Shared interface</h3>
<pre>
shared-interface
</pre>
<p>A stub library that only lists the imports and exports of a shared library. You can link against this library, but it doesn't have any executable code.</p><h3>Linker Map<h3>
<pre>
no-linkermap
</pre>
<p>Specifying this flavor suppresses the generation of a LinkMap.txt file, which is normally generated by the Apple linker (ld).</p><h2 id="analysis_http">Analysis flavors <a class="inline-link" href="#analysis_http">#</a></h2><h3>Rust language</h3>
<pre>
check
</pre>
<p>The Rust compiler has a build mode which quickly checks syntax and type correctness, but avoids codegen (which is the slowest phase of Rust compilation). This flavor invokes check on the suffixed build target.</p> 
<pre>
save-analysis
</pre>
<p>The <code>#save-analysis</code> flavor is an extension of #check. It performs the same actions as a #check build, but also emits a .json file containing full type/symbol cross-reference information, for consumption by tools like RLS (Rust Language Services).</p>
<pre>
doc
</pre>
<p>The <code>#doc</code> flavor is the equivalent of the cargo doc command. It uses the rustdoc tool to generate documentation for a target and its dependencies.</p><h3>Compilation database</h3><p>If you specify one of these flavors, Buck generates analysis information about your build.</p>
<pre>
compilation-database
</pre>
<p>Produces a JSON file that contains (an approximation of) the compiler commands for compiling each file. The output is in the <a href="https://eli.thegreenplace.net/2014/05/21/compilation-databases-for-clang-based-tools">clang compilation database</a> format.</p><h3>Infer</h3>
<pre>
infer-analyze
infer-capture-all
</pre>
<p>These flavors run <a href="https://fbinfer.com">Facebook's Infer tool</a> and generate intermediate Infer output.</p><h2 id="symbol_http">Symbol stripping flavors<a class="inline-link" href="#symbol_http">#</a></h2><p>These flavor control how symbols are stripped from an output binary.</p><h3>Strip debug</h3>
<pre>
strip-debug
</pre>
<p>Strip debug symbols; equivalent to <code>strip -S</code>.</p><h3>Strip debug and non-external</h3> 
<pre>
strip-non-global
</pre>
<p>Strip debug and non-external symbols; equivalent to <code>strip -x</code>.</p><h3>Strip all</h3> 
<pre>
strip-all
</pre>
<p>Strip all the things; equivalent to strip with no arguments.</p><h2 id="header_http">Header Flavors<a class="inline-link" href="#header_http">#</a></h2><p>These flavors are used with C++ header files, in the deps or exported_deps attributes of a Buck target.</p><h3>Headers used to compile a libraries own files</h3>
<pre>
private-headers
</pre>
<p>Symlink tree, or header map, of headers used for compiling a library's own files.</p><h3>Headers used to compile files that depend on this library</h3> 
<pre>
headers
</pre>
<p>Symlink tree, or header map, of headers used to compile files for other libraries that depend on this library.</p><h2 id="apple_debug_http">Apple debug flavors<a class="inline-link" href="#apple_debug_http">#</a></h2><p>Selects the actual binary used to represent a <a href="/rule/cxx_binary.html"><code>cxx_binary</code></a>.</p><h3>Stripped binary</h3>
<pre>
no-debug
</pre>
<p>Selects the stripped binary</p><h3>Unstripped binary</h3> 
<pre>
dwarf
</pre>
<p>Selects the unstripped binary</p><h3>Unstripped + dsym</h3> 
<pre>
dwarf-and-dsym
</pre>
<p>Selects the unstripped binary, and the dsym file.</p><h3>Other</h3> 
<pre>
apple-debuggable-binary
</pre>
<p>Could be stripped and unstripped, depending on requirements.</p><h2 id="apple_bundles_http">Apple bundles flavors<a class="inline-link" href="#apple_bundles_http">#</a></h2><p>These flavors are legacy methods of creating app and framework bundles.</p><p><em>You should not use these.</em></p><p>Instead of these flavors, we now use the Buck rule, <a href="/rule/apple_bundle.html"><code>apple_bundle</code></a></p><h3>App</h3>
<pre>
app
binary#app
</pre>
<p>Generates an app bundle.</p><h3>Framework</h3>
<pre>
framework
library#framework
</pre>
<p>Generates a framework.</p></div></article><nav><h3>The Basics</h3><ul><li class=""><a href="/setup/getting_started.html">Getting Started</a></li><li class=""><a href="/about/overview.html">Key Concepts</a></li><li class=""><a href="/learning/tutorial.html">Tutorial</a></li><li class=""><a href="/setup/intellij_plugin_install.html">Installing the IntelliJ Plugin</a></li><li class=""><a href="/article/exopackage.html">Exopackage</a></li><li class=""><a href="/article/query_cheat_sheet.html">Buck Cheat Sheet</a></li></ul><h3>About</h3><ul><li class=""><a href="/concept/what_makes_buck_so_fast.html">What Makes Buck so Fast?</a></li><li class=""><a href="/about/showcase.html">Showcase</a></li><li class=""><a href="/concept/troubleshooting.html">Troubleshooting</a></li><li class=""><a href="/about/performance_tuning.html">Performance Tuning</a></li><li class=""><a href="/concept/faq.html">FAQ</a></li><li class=""><a href="/presentations/index.html">Learn More (Buck Presentations)</a></li></ul><h3>Concepts</h3><ul><li class=""><a href="/concept/build_rule.html">Build Rule</a></li><li class=""><a href="/concept/build_file.html">Build File</a></li><li class=""><a href="/concept/build_target.html">Build Target</a></li><li class=""><a href="/concept/build_target_pattern.html">Build Target Pattern</a></li><li class=""><a href="/concept/buckd.html">Buck Daemon (buckd)</a></li><li class=""><a href="/concept/visibility.html">Visibility</a></li><li class="navActiveItem"><a href="/concept/flavors.html">Flavors</a></li><li class=""><a href="/concept/http_cache_api.html">HTTP Cache API</a></li><li class=""><a href="/concept/rule_keys.html">Rule Keys</a></li><li class=""><a href="/concept/java_abis.html">Java ABIs</a></li><li class=""><a href="/concept/skylark.html">Skylark</a></li></ul><h3>Files and Directories</h3><ul><li class=""><a href="/files-and-dirs/buckconfig.html">.buckconfig</a></li><li class=""><a href="/files-and-dirs/buckjavaargs.html">.buckjavaargs</a></li><li class=""><a href="/files-and-dirs/buck-out.html">buck-out</a></li></ul><h3>Commands</h3><ul><li class=""><a href="/command/common_parameters.html">Common Parameters</a></li><li class=""><a href="/command/audit.html">buck audit</a></li><li class=""><a href="/command/build.html">buck build</a></li><li class=""><a href="/command/clean.html">buck clean</a></li><li class=""><a href="/command/doctor.html">buck doctor</a></li><li class=""><a href="/command/fetch.html">buck fetch</a></li><li class=""><a href="/command/fix.html">buck fix</a></li><li class=""><a href="/command/install.html">buck install</a></li><li class=""><a href="/command/kill.html">buck kill</a></li><li class=""><a href="/command/killall.html">buck killall</a></li><li class=""><a href="/command/project.html">buck project</a></li><li class=""><a href="/command/publish.html">buck publish</a></li><li class=""><a href="/command/query.html">buck query</a></li><li class=""><a href="/command/run.html">buck run</a></li><li class=""><a href="/command/root.html">buck root</a></li><li class=""><a href="/command/server.html">buck server</a></li><li class=""><a href="/command/targets.html">buck targets</a></li><li class=""><a href="/command/test.html">buck test</a></li><li class=""><a href="/command/uninstall.html">buck uninstall</a></li><li class=""><a href="/command/exit_codes.html">Exit Codes</a></li></ul><h3>Build Rules</h3><ul><li><strong>Core</strong></li><li class=""><a href="/rule/command_alias.html">command_alias()</a></li><li class=""><a href="/rule/export_file.html">export_file()</a></li><li class=""><a href="/rule/filegroup.html">filegroup()</a></li><li class=""><a href="/rule/genrule.html">genrule()</a></li><li class=""><a href="/rule/http_archive.html">http_archive()</a></li><li class=""><a href="/rule/http_file.html">http_file()</a></li><li class=""><a href="/rule/remote_file.html">remote_file()</a></li><li class=""><a href="/rule/test_suite.html">test_suite()</a></li><li class=""><a href="/rule/worker_tool.html">worker_tool()</a></li><li class=""><a href="/rule/zip_file.html">zip_file()</a></li><li><strong>Android</strong></li><li class=""><a href="/rule/android_aar.html">android_aar()</a></li><li class=""><a href="/rule/android_binary.html">android_binary()</a></li><li class=""><a href="/rule/android_build_config.html">android_build_config()</a></li><li class=""><a href="/rule/android_instrumentation_apk.html">android_instrumentation_apk()</a></li><li class=""><a href="/rule/android_instrumentation_test.html">android_instrumentation_test()</a></li><li class=""><a href="/rule/android_library.html">android_library()</a></li><li class=""><a href="/rule/android_manifest.html">android_manifest()</a></li><li class=""><a href="/rule/android_prebuilt_aar.html">android_prebuilt_aar()</a></li><li class=""><a href="/rule/android_resource.html">android_resource()</a></li><li class=""><a href="/rule/apk_genrule.html">apk_genrule()</a></li><li class=""><a href="/rule/gen_aidl.html">gen_aidl()</a></li><li class=""><a href="/rule/keystore.html">keystore()</a></li><li class=""><a href="/rule/ndk_library.html">ndk_library()</a></li><li class=""><a href="/rule/prebuilt_jar.html">prebuilt_jar()</a></li><li class=""><a href="/rule/prebuilt_native_library.html">prebuilt_native_library()</a></li><li class=""><a href="/rule/robolectric_test.html">robolectric_test()</a></li><li><strong>CXX</strong></li><li class=""><a href="/rule/cxx_binary.html">cxx_binary()</a></li><li class=""><a href="/rule/cxx_library.html">cxx_library()</a></li><li class=""><a href="/rule/cxx_genrule.html">cxx_genrule()</a></li><li class=""><a href="/rule/cxx_precompiled_header.html">cxx_precompiled_header()</a></li><li class=""><a href="/rule/cxx_test.html">cxx_test()</a></li><li class=""><a href="/rule/prebuilt_cxx_library.html">prebuilt_cxx_library()</a></li><li class=""><a href="/rule/prebuilt_cxx_library_group.html">prebuilt_cxx_library_group()</a></li><li><strong>D</strong></li><li class=""><a href="/rule/d_binary.html">d_binary()</a></li><li class=""><a href="/rule/d_library.html">d_library()</a></li><li class=""><a href="/rule/d_test.html">d_test()</a></li><li><strong>Go</strong></li><li class=""><a href="/rule/go_binary.html">go_binary()</a></li><li class=""><a href="/rule/go_library.html">go_library()</a></li><li class=""><a href="/rule/go_test.html">go_test()</a></li><li class=""><a href="/rule/cgo_library.html">cgo_library()</a></li><li><strong>Groovy</strong></li><li class=""><a href="/rule/groovy_library.html">groovy_library()</a></li><li><strong>Halide</strong></li><li class=""><a href="/rule/halide_library.html">halide_library()</a></li><li><strong>Haskell</strong></li><li class=""><a href="/rule/haskell_binary.html">haskell_binary()</a></li><li class=""><a href="/rule/haskell_library.html">haskell_library()</a></li><li class=""><a href="/rule/prebuilt_haskell_library.html">prebuilt_haskell_library()</a></li><li><strong>iOS</strong></li><li class=""><a href="/rule/apple_asset_catalog.html">apple_asset_catalog()</a></li><li class=""><a href="/rule/apple_binary.html">apple_binary()</a></li><li class=""><a href="/rule/apple_bundle.html">apple_bundle()</a></li><li class=""><a href="/rule/apple_library.html">apple_library()</a></li><li class=""><a href="/rule/apple_package.html">apple_package()</a></li><li class=""><a href="/rule/apple_resource.html">apple_resource()</a></li><li class=""><a href="/rule/apple_test.html">apple_test()</a></li><li class=""><a href="/rule/core_data_model.html">core_data_model()</a></li><li class=""><a href="/rule/prebuilt_apple_framework.html">prebuilt_apple_framework()</a></li><li><strong>Java</strong></li><li class=""><a href="/rule/java_binary.html">java_binary()</a></li><li class=""><a href="/rule/java_library.html">java_library()</a></li><li class=""><a href="/rule/java_test.html">java_test()</a></li><li class=""><a href="/rule/prebuilt_jar.html">prebuilt_jar()</a></li><li class=""><a href="/rule/prebuilt_native_library.html">prebuilt_native_library()</a></li><li><strong>Kotlin</strong></li><li class=""><a href="/rule/kotlin_library.html">kotlin_library()</a></li><li class=""><a href="/rule/kotlin_test.html">kotlin_test()</a></li><li><strong>Lua</strong></li><li class=""><a href="/rule/cxx_lua_extension.html">cxx_lua_extension()</a></li><li class=""><a href="/rule/lua_binary.html">lua_binary()</a></li><li class=""><a href="/rule/lua_library.html">lua_library()</a></li><li><strong>OCaml</strong></li><li class=""><a href="/rule/ocaml_binary.html">ocaml_binary()</a></li><li class=""><a href="/rule/ocaml_library.html">ocaml_library()</a></li><li><strong>Python</strong></li><li class=""><a href="/rule/prebuilt_python_library.html">prebuilt_python_library()</a></li><li class=""><a href="/rule/python_binary.html">python_binary()</a></li><li class=""><a href="/rule/python_library.html">python_library()</a></li><li class=""><a href="/rule/python_test.html">python_test()</a></li><li><strong>Rust</strong></li><li class=""><a href="/rule/rust_binary.html">rust_binary()</a></li><li class=""><a href="/rule/rust_library.html">rust_library()</a></li><li class=""><a href="/rule/rust_test.html">rust_test()</a></li><li class=""><a href="/rule/prebuilt_rust_library.html">prebuilt_rust_library()</a></li><li><strong>Shell</strong></li><li class=""><a href="/rule/sh_binary.html">sh_binary()</a></li><li class=""><a href="/rule/sh_test.html">sh_test()</a></li><li><strong>.NET</strong></li><li class=""><a href="/rule/csharp_library.html">csharp_library()</a></li><li class=""><a href="/rule/prebuilt_dotnet_library.html">prebuilt_dotnet_library()</a></li></ul><h3>Functions</h3><ul><li><strong>Python DSL</strong></li><li class=""><a href="/function/add_build_file_dep.html">add_build_file_dep()</a></li><li class=""><a href="/function/allow_unsafe_import.html">allow_unsafe_import()</a></li><li class=""><a href="/function/flatten_dicts.html">flatten_dicts()</a></li><li class=""><a href="/function/glob.html">glob()</a></li><li class=""><a href="/function/get_base_path.html">get_base_path()</a></li><li class=""><a href="/function/get_cell_name.html">get_cell_name()</a></li><li class=""><a href="/function/host_info.html">host_info()</a></li><li class=""><a href="/function/include_defs.html">include_defs()</a></li><li class=""><a href="/function/load.html">load()</a></li><li class=""><a href="/function/read_config.html">read_config()</a></li><li class=""><a href="/function/subdir_glob.html">subdir_glob()</a></li><li class=""><a href="/function/string_parameter_macros.html">String Parameter Macros</a></li></ul><ul><li><strong>Skylark</strong></li><li class=""><a href="/skylark/generated/glob.html">glob()</a></li><li class=""><a href="/skylark/generated/host_info.html">host_info()</a></li><li class=""><a href="/skylark/generated/package_name.html">package_name()</a></li><li class=""><a href="/skylark/generated/provider.html">provider()</a></li><li class=""><a href="/skylark/generated/read_config.html">read_config()</a></li><li class=""><a href="/skylark/generated/repository_name.html">repository_name()</a></li><li class=""><a href="/skylark/generated/rule_exists.html">rule_exists()</a></li></ul><h3>Extending Buck</h3><ul><li class=""><a href="/extending/macros.html">Custom Macros</a></li><li class=""><a href="/extending/rules.html">Custom Rules</a></li><li class=""><a href="/extending/e2e_tests.html">Building E2E Tests for Buck</a></li></ul></nav></div></section><footer><div class='width'>&copy; Copyright Facebook, 2013 - 2020</div></footer><!-- Algolia Search Code --><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
docsearch({
  apiKey: 'c25b7174e8f6161ce5fdd44bb0b95081',
  indexName: 'buckbuild',
  inputSelector: '#algolia-doc-search',
  debug: false // Set debug to true if you want to inspect the dropdown
});
</script><!-- End Algolia Search Code --><script src="/google-code-prettify/prettify.js"></script><script>prettyPrint()</script></body></html>